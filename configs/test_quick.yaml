# Quick test configuration for verifying training pipeline
# Runs for just 30 steps to validate end-to-end functionality

model:
  backbone: "resnet50"  # Faster than ViT for testing
  num_classes: 5  # PubLayNet: text, title, list, table, figure
  freeze_backbone: false
  use_pretrained_backbone: false  # Faster initialization for testing

detr:
  # Smaller DETR for faster testing
  num_queries: 100  # Reduced from 300
  encoder_layers: 2  # Reduced from 6
  decoder_layers: 2  # Reduced from 6
  encoder_attention_heads: 4  # Reduced from 8
  decoder_attention_heads: 4  # Reduced from 8
  encoder_ffn_dim: 512  # Reduced from 1024
  decoder_ffn_dim: 512  # Reduced from 1024
  num_feature_levels: 4
  decoder_n_points: 4
  encoder_n_points: 4

data:
  dataset: "publaynet"
  train_split: "train"
  val_split: "validation"  # PubLayNet uses 'validation' not 'val'
  image_size: 512
  batch_size: 2  # Small batch for testing
  num_workers: 2

augmentation:
  horizontal_flip: 0.5
  rotate_limit: 5
  brightness_contrast: 0.2
  noise_std: 0.01

training:
  # TrainingArguments parameters - minimal for testing
  num_train_epochs: 1  # Just 1 epoch
  max_steps: 30  # Stop after 30 steps
  learning_rate: 1.0e-4
  weight_decay: 1.0e-4
  warmup_steps: 5  # Minimal warmup
  gradient_accumulation_steps: 1
  bf16: true
  save_steps: 100  # Don't save during test
  eval_steps: 15  # Eval halfway through
  logging_steps: 5
  eval_strategy: "steps"
  save_strategy: "no"  # Don't save checkpoints
  load_best_model_at_end: false
  metric_for_best_model: "eval_loss"
  greater_is_better: false
  push_to_hub: false

output:
  output_dir: "outputs/test_quick"
  log_dir: "outputs/test_quick/logs"
